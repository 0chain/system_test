name: "0Chain System Tests"
on:
  push:
  workflow_dispatch:

jobs:
  system-tests:
    name: "System Tests"
    runs-on: [ tests-suite ]
    timeout-minutes: 90
    steps:
      - name: "Config: Run tests against existing 0Chain network"
        shell: 'script --return --quiet --command "bash {0}"'
        run: |
          echo "^[[34mtest^[[39;49m^[[0m" > test.ansi
          cat test.ansi
          sudo apt install -y ansilove > build.log 2>&1 || { sleep 60 && sudo apt install -y ansilove > build.log 2>&1 || { cat build.log && echo "::error title=Failed to install dependency::failed to install ansilove, cannot send slack notification"; }; }
          ansilove -o ./output.png ./test.ansi

      - name: "Archive API Test Config & Console Output"
        uses: actions/upload-artifact@v3
        with:
         name: output.png
         path: |
          ./output.png
